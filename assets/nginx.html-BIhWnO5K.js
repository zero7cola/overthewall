import{_ as n,o as s,c as a,e}from"./app-CrO7TU3o.js";const t={},p=e(`<h1 id="lnmp" tabindex="-1"><a class="header-anchor" href="#lnmp"><span>LNMP</span></a></h1><h2 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx"><span>Nginx</span></a></h2><blockquote><p>laravel 官方 推荐nginx配置</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>server <span class="token punctuation">{</span>
    <span class="token comment"># 监听 HTTP 协议默认的 [80] 端口。</span>
    listen <span class="token number">80</span><span class="token punctuation">;</span>
    <span class="token comment"># 绑定主机名 [example.com]。</span>
    server_name example.com<span class="token punctuation">;</span>
    <span class="token comment"># 服务器站点根目录 [/example.com/public]。</span>
    root /example.com/public<span class="token punctuation">;</span>

    <span class="token comment"># 添加几条有关安全的响应头；与 Google+ 的配置类似，详情参见文末。</span>
    add_header X-Frame-Options <span class="token string">&quot;SAMEORIGIN&quot;</span><span class="token punctuation">;</span>
    add_header X-XSS-Protection <span class="token string">&quot;1; mode=block&quot;</span><span class="token punctuation">;</span>
    add_header X-Content-Type-Options <span class="token string">&quot;nosniff&quot;</span><span class="token punctuation">;</span>

    <span class="token comment"># 站点默认页面；可指定多个，将顺序查找。</span>
    <span class="token comment"># 例如，访问 http://example.com/ Nginx 将首先尝试「站点根目录/index.html」是否存在，不存在则继续尝试「站点根目录/index.htm」，以此类推...</span>
    index index.html index.htm index.php<span class="token punctuation">;</span>

    <span class="token comment"># 指定字符集为 UTF-8</span>
    charset utf-8<span class="token punctuation">;</span>

    <span class="token comment"># Laravel 默认重写规则；删除将导致 Laravel 路由失效且 Nginx 响应 404。</span>
    location / <span class="token punctuation">{</span>
        try_files <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.php?<span class="token variable">$query_string</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># 关闭 [/favicon.ico] 和 [/robots.txt] 的访问日志。</span>
    <span class="token comment"># 并且即使它们不存在，也不写入错误日志。</span>
    location <span class="token operator">=</span> /favicon.ico <span class="token punctuation">{</span> access_log off<span class="token punctuation">;</span> log_not_found off<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    location <span class="token operator">=</span> /robots.txt  <span class="token punctuation">{</span> access_log off<span class="token punctuation">;</span> log_not_found off<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment"># 将 [404] 错误交给 [/index.php] 处理，表示由 Laravel 渲染美观的错误页面。</span>
    error_page <span class="token number">404</span> /index.php<span class="token punctuation">;</span>

    <span class="token comment"># URI 符合正则表达式 [\\.php$] 的请求将进入此段配置</span>
    location ~ <span class="token punctuation">\\</span>.php$ <span class="token punctuation">{</span>
        <span class="token comment"># 配置 FastCGI 服务地址，可以为 IP:端口，也可以为 Unix socket。</span>
        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock<span class="token punctuation">;</span>
        <span class="token comment"># 配置 FastCGI 的主页为 index.php。</span>
        fastcgi_index index.php<span class="token punctuation">;</span>
        <span class="token comment"># 配置 FastCGI 参数 SCRIPT_FILENAME 为 $realpath_root$fastcgi_script_name。</span>
        fastcgi_param SCRIPT_FILENAME <span class="token variable">$realpath_root</span><span class="token variable">$fastcgi_script_name</span><span class="token punctuation">;</span>
        <span class="token comment"># 引用更多默认的 FastCGI 参数。</span>
        include fastcgi_params<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># 通俗地说，以上配置将所有 URI 以 .php 结尾的请求，全部交给 PHP-FPM 处理。</span>

    <span class="token comment"># 除符合正则表达式 [/\\.(?!well-known).*] 之外的 URI，全部拒绝访问</span>
    <span class="token comment"># 也就是说，拒绝公开以 [.] 开头的目录，[.well-known] 除外</span>
    location ~ /<span class="token punctuation">\\</span>.<span class="token punctuation">(</span>?<span class="token operator">!</span>well-known<span class="token punctuation">)</span>.* <span class="token punctuation">{</span>
        deny all<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4),o=[p];function c(i,l){return s(),a("div",null,o)}const m=n(t,[["render",c],["__file","nginx.html.vue"]]),d=JSON.parse('{"path":"/posts/nginx.html","title":"LNMP","lang":"zh-CN","frontmatter":{"date":"2025-11-02T00:00:00.000Z","category":["技术"],"tag":["nginx","lnmp"]},"headers":[{"level":2,"title":"Nginx","slug":"nginx","link":"#nginx","children":[]}],"git":{"updatedTime":1762309671000},"filePathRelative":"posts/nginx.md","excerpt":"\\n<h2>Nginx</h2>\\n<blockquote>\\n<p>laravel 官方 推荐nginx配置</p>\\n</blockquote>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>server <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token comment\\"># 监听 HTTP 协议默认的 [80] 端口。</span>\\n    listen <span class=\\"token number\\">80</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token comment\\"># 绑定主机名 [example.com]。</span>\\n    server_name example.com<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token comment\\"># 服务器站点根目录 [/example.com/public]。</span>\\n    root /example.com/public<span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># 添加几条有关安全的响应头；与 Google+ 的配置类似，详情参见文末。</span>\\n    add_header X-Frame-Options <span class=\\"token string\\">\\"SAMEORIGIN\\"</span><span class=\\"token punctuation\\">;</span>\\n    add_header X-XSS-Protection <span class=\\"token string\\">\\"1; mode=block\\"</span><span class=\\"token punctuation\\">;</span>\\n    add_header X-Content-Type-Options <span class=\\"token string\\">\\"nosniff\\"</span><span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># 站点默认页面；可指定多个，将顺序查找。</span>\\n    <span class=\\"token comment\\"># 例如，访问 http://example.com/ Nginx 将首先尝试「站点根目录/index.html」是否存在，不存在则继续尝试「站点根目录/index.htm」，以此类推...</span>\\n    index index.html index.htm index.php<span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># 指定字符集为 UTF-8</span>\\n    charset utf-8<span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># Laravel 默认重写规则；删除将导致 Laravel 路由失效且 Nginx 响应 404。</span>\\n    location / <span class=\\"token punctuation\\">{</span>\\n        try_files <span class=\\"token variable\\">$uri</span> <span class=\\"token variable\\">$uri</span>/ /index.php?<span class=\\"token variable\\">$query_string</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n\\n    <span class=\\"token comment\\"># 关闭 [/favicon.ico] 和 [/robots.txt] 的访问日志。</span>\\n    <span class=\\"token comment\\"># 并且即使它们不存在，也不写入错误日志。</span>\\n    location <span class=\\"token operator\\">=</span> /favicon.ico <span class=\\"token punctuation\\">{</span> access_log off<span class=\\"token punctuation\\">;</span> log_not_found off<span class=\\"token punctuation\\">;</span> <span class=\\"token punctuation\\">}</span>\\n    location <span class=\\"token operator\\">=</span> /robots.txt  <span class=\\"token punctuation\\">{</span> access_log off<span class=\\"token punctuation\\">;</span> log_not_found off<span class=\\"token punctuation\\">;</span> <span class=\\"token punctuation\\">}</span>\\n\\n    <span class=\\"token comment\\"># 将 [404] 错误交给 [/index.php] 处理，表示由 Laravel 渲染美观的错误页面。</span>\\n    error_page <span class=\\"token number\\">404</span> /index.php<span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token comment\\"># URI 符合正则表达式 [\\\\.php$] 的请求将进入此段配置</span>\\n    location ~ <span class=\\"token punctuation\\">\\\\</span>.php$ <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token comment\\"># 配置 FastCGI 服务地址，可以为 IP:端口，也可以为 Unix socket。</span>\\n        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock<span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token comment\\"># 配置 FastCGI 的主页为 index.php。</span>\\n        fastcgi_index index.php<span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token comment\\"># 配置 FastCGI 参数 SCRIPT_FILENAME 为 $realpath_root$fastcgi_script_name。</span>\\n        fastcgi_param SCRIPT_FILENAME <span class=\\"token variable\\">$realpath_root</span><span class=\\"token variable\\">$fastcgi_script_name</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token comment\\"># 引用更多默认的 FastCGI 参数。</span>\\n        include fastcgi_params<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n    <span class=\\"token comment\\"># 通俗地说，以上配置将所有 URI 以 .php 结尾的请求，全部交给 PHP-FPM 处理。</span>\\n\\n    <span class=\\"token comment\\"># 除符合正则表达式 [/\\\\.(?!well-known).*] 之外的 URI，全部拒绝访问</span>\\n    <span class=\\"token comment\\"># 也就是说，拒绝公开以 [.] 开头的目录，[.well-known] 除外</span>\\n    location ~ /<span class=\\"token punctuation\\">\\\\</span>.<span class=\\"token punctuation\\">(</span>?<span class=\\"token operator\\">!</span>well-known<span class=\\"token punctuation\\">)</span>.* <span class=\\"token punctuation\\">{</span>\\n        deny all<span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre></div>"}');export{m as comp,d as data};
